input: p/0, s/0.
output: r/0.
